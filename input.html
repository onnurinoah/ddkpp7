<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>보이는라디오 시청자 참여</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // Firebase 설정 (본인의 설정값으로 교체 필수)
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // 댓글 전송 함수
        window.submitComment = () => {
            const nickname = document.getElementById('nickname').value;
            const text = document.getElementById('comment-input').value;
            if(!nickname || !text) return alert("닉네임과 댓글을 입력해주세요!");
            
            push(ref(db, 'comments'), { 
                nickname, 
                text, 
                timestamp: Date.now() 
            });
            document.getElementById('comment-input').value = '';
            alert("댓글이 등록되었습니다!");
        };

        // 투표 함수
        window.vote = (type) => {
            const voteRef = ref(db, `votes/${type}`);
            onValue(voteRef, (snapshot) => {
                const current = snapshot.val() || 0;
                set(ref(db, `votes/${type}`), current + 1);
            }, { onlyOnce: true });
            alert(type.toUpperCase() + "에 투표했습니다!");
        };
    </script>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen p-4">
    <div class="w-full max-w-sm bg-white p-6 rounded-3xl shadow-xl border border-gray-100">
        <h1 class="text-xl font-bold text-center text-gray-800 mb-6">보이는라디오 시청자 참여</h1>
        
        <div class="space-y-3 mb-8">
            <input id="nickname" type="text" placeholder="닉네임 입력" 
                   class="w-full border border-gray-300 p-3 rounded-xl focus:ring-2 focus:ring-green-500 outline-none">
            <textarea id="comment-input" rows="3" placeholder="댓글을 남겨주세요" 
                      class="w-full border border-gray-300 p-3 rounded-xl focus:ring-2 focus:ring-green-500 outline-none"></textarea>
            <button onclick="submitComment()" 
                    class="w-full bg-green-600 text-white py-3 rounded-xl font-bold hover:bg-green-700 transition">댓글 등록</button>
        </div>

        <hr class="mb-6">

        <div class="text-center">
            <p class="text-sm font-semibold text-gray-500 mb-3">시청자 투표</p>
            <div class="flex gap-4">
                <button onclick="vote('o')" 
                        class="flex-1 bg-blue-500 text-white py-5 rounded-2xl text-3xl font-black shadow-lg active:scale-95 transition">O</button>
                <button onclick="vote('x')" 
                        class="flex-1 bg-red-500 text-white py-5 rounded-2xl text-3xl font-black shadow-lg active:scale-95 transition">X</button>
            </div>
        </div>
    </div>
</body>
</html>
